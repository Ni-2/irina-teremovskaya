$(function(){$.fn.imagesLoaded=function(callback){var $images=this.find('img'),len=$images.length,_this=this,blank='data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==';function triggerCallback(){callback.call(_this,$images)}function imgLoaded(){if(--len<=0&&this.src!==blank){setTimeout(triggerCallback);$images.unbind('load error',imgLoaded)}}if(!len){triggerCallback()}$images.bind('load error',imgLoaded).each(function(){if(this.complete||this.complete===undefined){var src=this.src;this.src=blank;this.src=src}});return this};var $rgGallery=$('#rg-gallery2'),$esCarousel=$rgGallery.find('div.es-carousel-wrapper'),$items=$esCarousel.find('ul > li'),itemsCount=$items.length;Gallery=(function(){var current=0,mode='carousel',anim=false,init=function(){$items.add('<img src="slick/ajax-loader.gif"/>').imagesLoaded(function(){_addViewModes();_addImageWrapper();_showImage($items.eq(current))});_initCarousel()},_initCarousel=function(){$esCarousel.show().elastislide({imageW:65,onClick:function($item){if(anim)return false;anim=true;_showImage($item);current=$item.index()}});$esCarousel.elastislide('setCurrent',current)},_addViewModes=function(){},_addImageWrapper=function(){$('#img-wrapper-tmpl').tmpl({itemsCount:itemsCount}).appendTo($rgGallery);if(itemsCount>1){var $navPrev=$rgGallery.find('a.rg-image-nav-prev'),$navNext=$rgGallery.find('a.rg-image-nav-next'),$imgWrapper=$rgGallery.find('div.rg-image');$navPrev.bind('click.rgGallery',function(event){_navigate('left');return false});$navNext.bind('click.rgGallery',function(event){_navigate('right');return false});$imgWrapper.touchwipe({wipeLeft:function(){_navigate('right')},wipeRight:function(){_navigate('left')},preventDefaultEvents:false});$(document).bind('keyup.rgGallery',function(event){if(event.keyCode==39)_navigate('right');else if(event.keyCode==37)_navigate('left')})}},_navigate=function(dir){if(anim)return false;anim=true;if(dir==='right'){if(current+1>=itemsCount)current=0;else++current}else if(dir==='left'){if(current-1<0)current=itemsCount-1;else--current}_showImage($items.eq(current))},_showImage=function($item){var $loader=$rgGallery.find('div.rg-loading').show();$items.removeClass('selected');$item.addClass('selected');var $thumb=$item.find('img'),largesrc=$thumb.data('large'),biggest=$thumb.data('biggest'),title1=$thumb.data('description1'),title2=$thumb.data('description2'),title3=$thumb.data('description3');$('<img/>').load(function(){$rgGallery.find('div.rg-image').empty().append('<img src="'+largesrc+'"/><a href="'+biggest+'" data-lightbox="roadtrip" data-title="'+title1+'<br>'+title2+'<br>'+title3+'"></a>');if(title1)$rgGallery.find('div.rg-caption1').show().children('p').empty().text(title1);if(title2)$rgGallery.find('div.rg-caption2').show().children('p').empty().text(title2);if(title3)$rgGallery.find('div.rg-caption3').show().children('p').empty().text(title3);$loader.hide();if(mode==='carousel'){$esCarousel.elastislide('reload');$esCarousel.elastislide('setCurrent',current)}anim=false}).attr('src',largesrc)};return{init:init}})();Gallery.init()});